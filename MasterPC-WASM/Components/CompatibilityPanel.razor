<div style="width: 100%; padding: .5rem 2rem; border-radius: 0 0 15px 15px; background-color: @(GetCompatibilityPanelColor())">
    <div style="display: flex; align-items: center">
        <div style="width: 100%; height: 100%; display: flex; align-items: center">
            @if (_compatible)
            {
                <MudIcon Icon="@Icons.Material.Filled.Check" Color="Color.Inherit" Style="margin: 4; color: white" />
            }
            else
            {
                <MudIcon Icon="@Icons.Material.Filled.Block" Style="margin: 4; color: white" />
            }
            &nbsp;

            <MudText Typo="Typo.h6" Style="font-weight: 600; margin-left: 10px; color: white">
                Compatibility Check: &nbsp;
            </MudText>

            @if (_compatible)
            {
                <MudText Typo="Typo.h6" Style="color: white; font-weight: 400">
                    These parts are compatible with each other. See <MudLink Underline="Underline.Hover" Typo="Typo.h6" OnClick="ShowCompatibilityPanel" Style="color: white; font-weight: 400">disclaimer</MudLink> for more details.
                </MudText>
            }
            else
            {
                <MudText Typo="Typo.h6" Style="color: white; font-weight: 400">
                    <b>
                        Warning!
                    </b>
                    These parts have potential issues or incompatibilities. <MudLink Underline="Underline.Hover" Color="Color.Surface" Typo="Typo.inherit" OnClick="ShowCompatibilityPanel" Style="color: white; font-weight: 500; text-decoration-color: white">Click here for more information.</MudLink>
                </MudText>

                <MudIconButton Icon="@(_compatibilityPanelVisible ? Icons.Material.Filled.ExpandLess : Icons.Material.Filled.ExpandMore)" Color="Color.Surface" Style="margin-left: 5px; color: white" OnClick="ShowCompatibilityPanel" />
            }
        </div>
    </div>
    <MudCollapse Expanded="_compatibilityPanelVisible">
        <MudList Style="color: white;">
            @foreach (var message in CompatibilityMessages)
            {
                <MudListItem>
                    <MudStack Row Spacing="2" AlignItems="AlignItems.Center">
                        <MudIcon Icon="@Icons.Material.Filled.Error" />
                        <MudText Typo="Typo.body2" Style="color: white; font-weight: 400">
                            @message
                        </MudText>
                    </MudStack>
                </MudListItem>
            }
        </MudList>
    </MudCollapse>
</div>

@code {
    [CascadingParameter(Name = "theme")]
    private MyMudTheme? theme { get; set; }

    [Parameter]
    public List<string> CompatibilityMessages { get; set; } = null!;

    private bool _compatible { get; set; } = false;

    private bool _compatibilityPanelVisible { get; set; } = false;

    protected override Task OnInitializedAsync()
    {
        _compatible = CompatibilityMessages.Count == 0;

        return base.OnInitializedAsync();
    }
    private void ShowCompatibilityPanel()
    {
        _compatibilityPanelVisible = !_compatibilityPanelVisible;
    }

    private string GetCompatibilityPanelColor()
    {
        return _compatible ? theme.Palette.Success.ToString() : theme.Palette.ErrorDarken.ToString();
    }
}
